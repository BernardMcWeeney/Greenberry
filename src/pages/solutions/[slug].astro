---
import Layout from '../../layouts/Layout.astro';
import Container from '../../components/common/Container.astro';
import Button from '../../components/common/Button.astro';
import Badge from '../../components/ui/Badge.astro';
import PageHeader from '../../components/common/PageHeader.astro';
import PageCta from '../../components/common/PageCta.astro';
import FeatureCard from '../../components/services/FeatureCard.astro';
import ServiceCard from '../../components/services/ServiceCard.astro';
import ProcessSteps from '../../components/services/ProcessSteps.astro';
import ServiceFAQ from '../../components/services/ServiceFAQ.astro';

// Import solutions and services data
import { solutions } from '../../data/solutions';
import { services } from '../../data/services';
import type { Service } from '../../data/services';
import type { Solution } from '../../data/solutions';

export async function getStaticPaths() {
  return solutions.map(solution => ({
    params: { slug: solution.id },
    props: { solution },
  }));
}

interface Props {
  solution: Solution;
}

const { solution } = Astro.props;

// Get included services based on the solution's includes array with proper type checking
const includedServices = (solution.includes || [])
  .map(id => services.find(service => service.id === id))
  .filter((service): service is Service => service !== undefined);

// Determine the appropriate color for the solution
const solutionColor = solution.color || "indigo";
const textColorClass = solution.textColor || `text-${solutionColor}-500`;
const bgColorClass = `bg-${solutionColor}-500`;
const borderColorClass = solution.borderColor || `border-${solutionColor}-500`;

// Common FAQs for solutions
const solutionFaqs = [
  {
    question: "How does billing work for this solution?",
    answer: "Our solutions are typically offered as monthly subscriptions with clear, predictable pricing. You can choose to pay monthly or annually, with annual payments offering a discount. There are no hidden fees or unexpected costs."
  },
  {
    question: "Can I customize this solution to fit my specific needs?",
    answer: "Absolutely! While our solutions are designed to cover typical needs, we understand that every business is unique. We can customize any solution to add or remove specific services based on your requirements."
  },
  {
    question: "Is there a minimum contract period?",
    answer: "Most of our solutions have a 3-month minimum commitment, but you're free to cancel anytime after that. Some services, like website design and build, require an initial setup fee separate from the ongoing subscription."
  },
  {
    question: "How quickly can you implement this solution?",
    answer: "Implementation timelines vary depending on the specific solution and your existing setup. Basic solutions like Email and Domain Management can be implemented within days, while more comprehensive solutions like Website-as-a-Service might take 4-8 weeks for the initial setup."
  },
  {
    question: "What kind of support is included?",
    answer: "All our solutions include responsive email and phone support during business hours. We aim to respond to all inquiries within 24 hours, and urgent issues are typically addressed within 4 hours."
  }
];
---

<Layout title={`${solution.title} | Greenberry - Digital Solutions for Irish Businesses`}>
  <!-- Solution Hero Header -->
  <PageHeader
    title={solution.title}
    description={solution.description}
    backgroundVariant="decorated"
    badgeText="OUR SOLUTIONS"
    highlightedText={solution.title.split(' ')[0]}
    highlightPosition="start"
    paddingY="lg"
  />
  
  <!-- Solution Overview -->
  <section class="py-16 bg-white dark:bg-gray-900">
    <Container>
      <div class="max-w-3xl mx-auto text-center mb-12">
        <div class="badge-wrapper">
          <Badge text="SOLUTION OVERVIEW" variant={solutionColor} size="md" />
        </div>
        <h2 class="heading-primary">
          What's Included
        </h2>
        <p class="section-description">
          This comprehensive solution combines multiple services to provide you with everything you need.
        </p>
      </div>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {(solution.features || []).map((feature, index) => (
          <div class="feature-card">
            <h3 class="text-lg font-semibold mb-2">{feature}</h3>
          </div>
        ))}
      </div>
    </Container>
  </section>
  
  <!-- Included Services Section -->
  {includedServices.length > 0 && (
    <section class="py-16 bg-gray-50 dark:bg-gray-800/50">
      <Container>
        <div class="max-w-3xl mx-auto text-center mb-12">
          <div class="badge-wrapper">
            <Badge text="INCLUDED SERVICES" variant={solutionColor} size="md" />
          </div>
          <h2 class="heading-primary">
            Services In This Solution
          </h2>
          <p class="section-description">
            This solution includes the following core services, all managed under one comprehensive package.
          </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          {includedServices.map((service) => {
            // Safely prepare features for the service card
            const serviceFeatures = Array.isArray(service.features) ? 
              service.features.slice(0, 3) : [];
              
            return (
              <ServiceCard 
                id={service.id}
                title={service.title}
                description={service.description}
                icon={service.icon}
                color={service.color}
                textColor={service.textColor}
                borderColor={service.borderColor}
                buttonTextColor="text-green-500" 
                features={serviceFeatures}
                link={service.link}
                ctaText={`Learn About ${service.title}`}
              />
            );
          })}
        </div>
      </Container>
    </section>
  )}
  
  <!-- Benefits Section -->
  <section class="py-16 bg-white dark:bg-gray-900">
    <Container>
      <div class="max-w-3xl mx-auto text-center mb-12">
        <div class="badge-wrapper">
          <Badge text="WHY CHOOSE THIS SOLUTION" variant={solutionColor} size="md" />
        </div>
        <h2 class="heading-primary">
          Key Benefits
        </h2>
        <p class="section-description">
          Here's why our {solution.title} is the smart choice for your business.
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="benefit-card">
          <div class={`${textColorClass} text-4xl mb-4`}>
            <i class="fa-solid fa-coins"></i>
          </div>
          <h3 class="text-xl font-bold mb-2">Cost Effective</h3>
          <p>Combined services cost less than purchasing them individually, saving you money while providing more value.</p>
        </div>
        
        <div class="benefit-card">
          <div class={`${textColorClass} text-4xl mb-4`}>
            <i class="fa-solid fa-sliders"></i>
          </div>
          <h3 class="text-xl font-bold mb-2">Simplified Management</h3>
          <p>One point of contact, one invoice, one cohesive strategy â€“ making your digital presence easier to manage.</p>
        </div>
        
        <div class="benefit-card">
          <div class={`${textColorClass} text-4xl mb-4`}>
            <i class="fa-solid fa-diagram-project"></i>
          </div>
          <h3 class="text-xl font-bold mb-2">Better Integration</h3>
          <p>All services work perfectly together, with no compatibility issues or gaps between different providers.</p>
        </div>
        
        <div class="benefit-card">
          <div class={`${textColorClass} text-4xl mb-4`}>
            <i class="fa-solid fa-clock"></i>
          </div>
          <h3 class="text-xl font-bold mb-2">Save Time</h3>
          <p>Let us handle the technical details so you can focus on running your business and serving your customers.</p>
        </div>
      </div>
    </Container>
  </section>
  
  <!-- FAQs -->
  <section class="py-16 bg-gray-50 dark:bg-gray-800/50">
    <Container>
      <div class="max-w-3xl mx-auto text-center mb-12">
        <div class="badge-wrapper">
          <Badge text="FAQ" variant={solutionColor} size="md" />
        </div>
        <h2 class="heading-primary">
          Common Questions
        </h2>
        <p class="section-description">
          Get answers to frequently asked questions about our {solution.title}.
        </p>
      </div>
      
      <ServiceFAQ faqs={solutionFaqs} />
    </Container>
  </section>
  
  <!-- CTA Section -->
  <PageCta
    title={`Ready to get started with ${solution.title}?`}
    description="Get in touch today for a free consultation and let's discuss how this solution can help your business thrive online."
    badgeText="GET STARTED"
    primaryButtonText={solution.ctaText || "Get Started"}
    primaryButtonHref="/contact"
    secondaryButtonText="Schedule a Call"
    secondaryButtonHref="tel:+353123456789"
    footnote="No commitment required. We'll respond within 24 hours."
  />
</Layout>

<style>
  .feature-card {
    background-color: white;
    padding: 1.5rem;
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .feature-card:hover {
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
  }

  .dark .feature-card {
    background-color: rgb(31, 41, 55);
    color: white;
  }

  .benefit-card {
    background-color: white;
    padding: 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }

  .benefit-card:hover {
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
  }

  .dark .benefit-card {
    background-color: rgb(31, 41, 55);
    color: white;
  }

  /* Animation delays */
  .animation-delay-700 {
    animation-delay: 700ms;
  }
  
  .animation-delay-1500 {
    animation-delay: 1500ms;
  }
</style>