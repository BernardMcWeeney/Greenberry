---
import Container from '../common/Container.astro';
import Badge from '../ui/Badge.astro';
import Button from '../common/Button.astro';
import Icon from '../common/Icon.astro'; // Make sure this path is correct

// Import suite data
import { suites, type Suite } from '../../data/suites'; // Adjust path if necessary

// Updated function for feature badge colors with dark mode support
const getFeatureBadgeColor = (colorName?: string) => {
  if (!colorName) return "bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";
  const colorLower = colorName.toLowerCase();
  switch(colorLower) {
    case "blue": return "bg-blue-100 text-blue-800 dark:bg-blue-700/50 dark:text-blue-300";
    case "green": return "bg-green-100 text-green-800 dark:bg-green-700/50 dark:text-green-300";
    case "purple": return "bg-purple-100 text-purple-800 dark:bg-purple-700/50 dark:text-purple-300";
    case "amber": return "bg-amber-100 text-amber-800 dark:bg-amber-700/50 dark:text-amber-300";
    case "yellow": return "bg-yellow-100 text-yellow-800 dark:bg-yellow-700/50 dark:text-yellow-300";
    case "red": return "bg-red-100 text-red-800 dark:bg-red-700/50 dark:text-red-300";
    case "indigo": return "bg-indigo-100 text-indigo-800 dark:bg-indigo-700/50 dark:text-indigo-300";
    default: return "bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";
  }
};
---

<section class="py-16 lg:py-24 bg-neutral-50 dark:bg-gray-800/50 relative overflow-hidden">
  <div class="absolute inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-0 right-0 w-96 h-96 bg-purple-500/10 rounded-full filter blur-3xl opacity-70 translate-x-1/3 -translate-y-1/3"></div>
    <div class="absolute bottom-0 left-0 w-96 h-96 bg-blue-500/10 rounded-full filter blur-3xl opacity-60 -translate-x-1/3 translate-y-1/3"></div>
  </div>

  <Container>
    <div class="max-w-3xl mx-auto text-center mb-12 lg:mb-16 relative z-10">
      <div class="badge-wrapper">
        <Badge text="TAILORED PACKAGES" variant="primary" size="md" />
      </div>
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4 leading-tight">
        Industry-Specific Digital Suites
      </h2>
      <p class="text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
        Explore our comprehensive suites, crafted with tailored solutions and services to meet the unique demands of your sector.
      </p>
    </div>

    {suites.length > 0 ? (
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8">
        {suites.map((suite) => {
          const suiteBaseColor = suite.color || 'gray'; // Fallback color
          const titleBadgeBgClass = `bg-${suiteBaseColor}-500`; // e.g., bg-blue-500
          const mainVisualBgClass = `bg-${suiteBaseColor}-500`; // e.g., bg-blue-500
          const mainVisualHoverBgClass = `hover:bg-${suiteBaseColor}-600`; // e.g., hover:bg-blue-600

          return (
            <a href={suite.link} class="group block rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 focus:outline-none focus:ring-2 focus:ring-${suiteBaseColor}-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800">
              <div class="relative">
                {/* Main Visual Area: Icon on Colored Background */}
                <div class={`w-full aspect-video relative flex items-center justify-center rounded-t-xl ${mainVisualBgClass} ${mainVisualHoverBgClass} transition-colors duration-300`}>
                  <Icon name={suite.icon} class="text-white text-6xl sm:text-7xl opacity-80 group-hover:scale-110 transition-transform duration-300" />
                </div>
                
                {/* Dark gradient overlay for text contrast */}
                <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/40 to-transparent opacity-100 rounded-t-xl"></div>
                
                {/* Target Sector Badge at Top */}
                <div class="absolute top-4 left-4 z-10">
                  <span class={`px-3 py-1 text-xs sm:text-sm font-semibold ${titleBadgeBgClass} text-white rounded-full shadow-sm`}>
                    {suite.targetSector || suite.title.split(' ')[0]}
                  </span>
                </div>
                
                {/* Content Overlay at Bottom */}
                <div class="absolute inset-x-0 bottom-0 p-4 sm:p-6 z-10">
                  <h3 class="text-xl sm:text-2xl font-bold text-white mb-1 sm:mb-2 group-hover:text-gray-100 transition-colors">
                    {suite.title}
                  </h3>
                  <p class="text-white/90 text-sm sm:text-base mb-3 sm:mb-4 line-clamp-2 group-hover:text-white transition-colors">
                    {suite.description}
                  </p>
                  {suite.features && suite.features.length > 0 && (
                    <div class="flex flex-wrap gap-1.5 sm:gap-2">
                      {suite.features.slice(0, 3).map(feature => ( // Show max 3 features for brevity
                        <span class={`px-2.5 py-1 rounded-full text-xs font-medium inline-block whitespace-nowrap ${getFeatureBadgeColor(suiteBaseColor)} shadow-sm`}>
                          {feature.split(':')[0]} {/* Show only title part of feature if applicable */}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            </a>
          );
        })}
      </div>
    ) : (
      <p class="text-center text-lg text-gray-600 dark:text-gray-300">
        No suites are currently available. Please check back soon!
      </p>
    )}
    
    <div class="text-center mt-12 lg:mt-16">
      <Button href="/suites" variant="primary" size="lg" class="gap-2 group shadow-lg hover:shadow-xl transition-shadow">
        Explore All Suites
        <Icon name="fa-solid fa-arrow-right" class="group-hover:translate-x-1 transition-transform duration-300" />
      </Button>
    </div>
  </Container>
</section>

<style>
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }
</style>